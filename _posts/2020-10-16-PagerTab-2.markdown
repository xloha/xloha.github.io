---
layout: post
title:  "(iOS) PagerTab êµ¬í˜„í•´ë³´ê¸° 2 / 2"
date:   2020-10-16 10:57:00 +0900
categories: iOS swift 
tags:
- PageViewController
- Delegate
---
<br>

í˜ì´ì§€ íƒ­ë°”ë¥¼ ë§Œë“¤ì–´ë³´ê¸°ë¡œ í–ˆë‹¤. ì•ˆë“œë¡œì´ë“œì™€ ë‹¬ë¦¬ iOSëŠ” Pager Tabì„ ì œê³µí•´ì£¼ì§€ ì•ŠëŠ”ë‹¤. ë”°ë¼ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë§ì´ ì“´ë‹¤ê³  í•œë‹¤. ì „ì²´ ì½”ë“œëŠ” [EUNPPINGMALL](https://github.com/EunYeongKim/EUNPPINGMALL) ì´ê³³ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.  

[ì—¬ê¸°ì„œ](https://yagom.net/forums/topic/pageviewcontroller%eb%a1%9c-ui-%ea%b5%ac%ec%84%b1%ed%95%98%ea%b8%b0/) ë„ì›€ì„ ë§ì´ ë°›ì•˜ê³ , ì½”ë“œë¥¼ ì°¸ê³ í•˜ì˜€ë‹¤. 

## ìµœì¢… ê²°ê³¼ë¬¼~ğŸ‘» 
<img src="/assets/image/SwiftPagerTab.png" style="zoom: 30%;"/> <img src="/assets/image/PagerTabGIF.gif" style="zoom: 60%;"/>

<br>

# 1. `Delegate` ìƒì†

```swift
class TabMenuPageViewController: UIPageViewController, UIPageViewControllerDataSource, UIPageViewControllerDelegate {
var menuDelegate: PageIndexDelegate?

let identifiers = ["ProductVC", "RecentVC", "WishListVC"]

lazy var VCArray: [UIViewController] = {
    return identifiers.map({ (id: String) -> (UIViewController) in
        return VCInstance(name: id)
    })
}()

...

}
```

* `PageViewController`ì˜ `DataSource`ì™€ `Delegate`ë¥¼ ëª¨ë‘ ìƒì†í•œë‹¤.
* `var menuDelegate` : í˜ì´ì§€ë¥¼ ìŠ¤í¬ë¡¤ í–ˆì„ ì‹œ ì•Œë§ì€ ë©”ë‰´ë¡œ ë©”ë‰´ë°”ë¥¼ ì´ë™í•˜ëŠ” ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´
* `let identifiers` : ë„ìš¸ í™”ë©´ì˜ ID

<br>

# 2. íƒ­ ë©”ë‰´ì— í•´ë‹¹í•˜ëŠ” í™”ë©´ ë„ìš°ê¸°

## ì´ˆê¸° í™”ë©´ ì„¤ì •

```swift
override func viewDidLoad() {
    super.viewDidLoad()
    
    self.dataSource = self
    self.delegate = self
    
    if let firstVC = VCArray.first {
        setViewControllers([firstVC], direction: .forward, animated: true, completion: nil)
    }
}
```
* `dataSource, delegate` ì§€ì • ë° ì´ˆê¸°ì— ë„ìš¸ í™”ë©´ì„ ì •í•´ì¤Œ

<br>

## `Delegate`ì£¼ì…

```swift
func setDelegate(_ viewController: UIViewController) {
    guard let vc = viewController as? TabMenuViewController else { return }
    vc.pageVCDelegate = self
}
```
* íƒ­ ë©”ë‰´ê°€ ìˆëŠ”(ë¶€ëª¨) ë·°ì˜ delegateë¥¼ ì£¼ì…í•œë‹¤.

<br>

## `Delegate` êµ¬í˜„

```swift
extension TabMenuPageViewController: PageViewControllerDelegate {
    func scrollPage(pageIndex: Int, previousIndex: Int) {
        let direction: UIPageViewController.NavigationDirection = (previousIndex > pageIndex) ? .reverse : .forward
        
        self.setViewControllers([VCArray[pageIndex]], direction: direction, animated: true, completion: nil)
    }
}
```
* ë©”ë‰´íƒ­ì´ ìˆëŠ” `Controller`ì—ì„œ ë©”ë‰´ë¥¼ ì„ íƒí–ˆì„ ì‹œ í•´ë‹¹ í™”ë©´ìœ¼ë¡œ ì´ë™í•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” í•¨ìˆ˜ì´ë‹¤.
* `previousIndex`ë¥¼ ë°›ì•„ì„œ ì• ë‹ˆë©”ì´ì…˜ì˜ ë°©í–¥ì„ ê²°ì •í•˜ì—¬ ì›€ì§ì„ì´ ìì—°ìŠ¤ëŸ¬ìš¸ ìˆ˜ ìˆë„ë¡ í•œë‹¤.

<br>

# `í™”ë©´ ìŠ¤í¬ë¡¤ ì‹œ ì•Œë§ëŠ” ë©”ë‰´ë¡œ ì–¸ë”ë°” ì›€ì§ì´ê¸°`
ë§Œë“¤ë©´ì„œ "ì´ê±° ì™œ ì´ëŸ¬ì§€" í–ˆë˜ ë¶€ë¶„ì´ë‹¤

## ìŠ¤í¬ë¡¤ ì‹œ ë³´ì—¬ì¤„ í™”ë©´ì„ ê²°ì •í•˜ê¸°

```swift
func pageViewController(_ pageViewController: UIPageViewController, viewControllerBefore viewController: UIViewController) -> UIViewController? {
    guard let viewControllerIndex = VCArray.firstIndex(of: viewController) else { return nil }
    
    let previousIndex = viewControllerIndex - 1
    
    if previousIndex < 0 {
        return VCArray.last
    } else {
        return VCArray[previousIndex]
    }
}

func pageViewController(_ pageViewController: UIPageViewController, viewControllerAfter viewController: UIViewController) -> UIViewController? {
    guard let viewControllerIndex = VCArray.firstIndex(of: viewController) else { return nil }
    
    let nextIndex = viewControllerIndex + 1
    
    if nextIndex >= VCArray.count {
        return VCArray.first
    } else {
        return VCArray[nextIndex]
    }
}
```

* `UIPageViewControllerDataSource`ë¥¼ ìƒì†í•˜ë©´ `viewControllerBefore, viewControllerAfter` ë‘ ê°œì˜ í•¨ìˆ˜ë¥¼ êµ¬í˜„í•˜ì—¬ ë³´ì—¬ì¤„ í™”ë©´ì„ ê²°ì •í•˜ê²Œ ëœë‹¤.
    ```swift
    if previousIndex < 0 {
        menuDelegate?.selectMenuItem(pageIndex: VCArray.endIndex)
        return VCArray.last
    } else {
        menuDelegate?.selectMenuItem(pageIndex: previousIndex)
        return VCArray[previousIndex]
    }
    ```
* ì²˜ìŒì— ì´ ë©”ì†Œë“œì— ë©”ë‰´ë°”ë¥¼ ì›€ì§ì´ëŠ” ì½”ë“œë¥¼ ìœ„ì™€ ê°™ì´ ë„£ì—ˆë‹¤. í•˜ì§€ë§Œ ì´ ë©”ì†Œë“œëŠ” ë‚´ ìƒê°ê³¼ ë‹¤ë¥´ê²Œ ìŠ¤í¬ë¡¤ì„ í•˜ë©´ **ë”± í•œë²ˆë§Œ ë¶ˆë¦¬ëŠ”** ë©”ì†Œë“œê°€ ì•„ë‹ˆì˜€ë‹¤. 
    * *ë”°ë¼ì„œ ë©”ë‰´ë°”ê°€ ì›í•˜ëŠ” ê³³ìœ¼ë¡œ ì›€ì§ì¼ ë•Œë„ ìˆì—ˆì§€ë§Œ ì›í•˜ëŠ” ë©”ë‰´ë¥¼ ê±´ë„ˆë›°ì–´ì„œ ì´ìƒí•œ ê³³ìœ¼ë¡œ ë©”ë‰´ë°”ê°€ ì´ë™í•˜ëŠ” ê²½ìš°ë„ ìˆì—ˆë‹¤.*
* `viewControllerBefore, viewControllerAfter`ëŠ” **`DataSource`** ë¡œ ë³´ì—¬ì¤„ í™”ë©´ì„ ë¯¸ë¦¬ ì¤€ë¹„í•  ìˆ˜ë„ ìˆê¸° ë•Œë¬¸ì— ë”± í•œë²ˆë§Œ ë¶ˆë¦¬ëŠ” ë©”ì†Œë“œê°€ ì•„ë‹ˆë‹¤. 
* ê·¸ëŸ¬ë¯€ë¡œ ë©”ë‰´ë°”ë¥¼ ì›€ì§ì´ëŠ” í•¨ìˆ˜ë¥¼ ì—¬ê¸°ì„œ í˜¸ì¶œí•˜ë©´ ì•ˆëœë‹¤

<br>

## í˜ì´ì§€ê°€ ì „í™˜ë˜ê¸° ì „ì— ë¶ˆë¦¬ëŠ” `willTransitionTo`

```swift
func pageViewController(_ pageViewController: UIPageViewController, willTransitionTo pendingViewControllers: [UIViewController]) {
    guard let next = pendingViewControllers.first, let vcIndex = VCArray.firstIndex(of: next) else { return }
    if vcIndex >= VCArray.count {
        menuDelegate?.selectMenuItem(pageIndex: 0)
    } else {
        menuDelegate?.selectMenuItem(pageIndex: vcIndex)
    }
}
```

* í˜ì´ì§€ê°€ ì „í™˜ë˜ê¸° ì´ì „ì— ë¶ˆë¦¬ëŠ” ë©”ì†Œë“œì¸ `willTransitionTo`ëŠ” `UIPageViewControllerDelegate`ë¥¼ ìƒì†í•˜ë©´ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
    * `pendingViewControllers`ëŠ” ë³´ì—¬ì§ˆ `viewController`ë“¤ì´ ë“¤ì–´ìˆë‹¤.
* ì´ ë©”ì†Œë“œ ì‚¬ìš©ìê°€ í™”ë©´ì„ ì „í™˜í•  ë•Œë§Œ ë¶ˆë¦¬ê¸° ë•Œë¬¸ì— ë‚´ê°€ ì›í•˜ëŠ”ëŒ€ë¡œ ë©”ë‰´ë°”ë¥¼ ì•Œë§ê²Œ ì›€ì§ì¼ ìˆ˜ ìˆì—ˆë‹¤. 


